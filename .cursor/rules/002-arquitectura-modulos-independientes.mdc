---
title: "Arquitectura de m√≥dulos independientes + pol√≠tica de dependencias"
description: "Regla ALWAYS: cada m√≥dulo es aut√≥nomo. Solo puede depender de github.com/xKoRx/sdk/*"
alwaysApply: true
---

# üîí N√∫cleo arquitect√≥nico (obligatorio)

## Principios
- **Independencia total**: ning√∫n m√≥dulo importa a otro m√≥dulo para no transformar en monorepo.
- **DIP/SOLID**: programa contra **interfaces**. Composici√≥n > herencia.
- **Config √∫nica**: usa **ETCD** de `github.com/xKoRx/echo/sdk/etcd`. Carga una vez al inicio. Inmutable en runtime.
- **Observabilidad est√°ndar**: `github.com/xKoRx/echo/sdk/telemetry` + bundles por dominio. Atributos en contexto.
- **Calidad**: robustez, modularidad, escalabilidad, clean code, SOLID. Tests ‚â•85%.

## Pol√≠tica de dependencias (permitido vs prohibido)
**Permitido**:
- **stdlib** de Go.
- `github.com/xKoRx/echo/{agent/core}/internal/di` (inyecci√≥n transversal, like `github.com/xKoRx/symphony/internal/di`)
- `github.com/xKoRx/sdk/...` (etcd, telemetry, utils de la SDK).
- Dependencias externas **no internas** del monorepo, justificadas en `go.mod` del m√≥dulo.

**Prohibido**:
- Cualquier import que apunte a **otro m√≥dulo** del monorepo:  
  `github.com/xKoRx/<otro-m√≥dulo>/...` ‚ùå
- Variables de entorno o YAML como configuraci√≥n en runtime ‚ùå, solo etcd

**Ejemplos**
```go
// ‚úÖ OK
import (
  "context"
  "github.com/xKoRx/echo/{core/agent}/internal/di"
  "github.com/xKoRx/echo/sdk/etcd"
  "github.com/xKoRx/echo/sdk/telemetry"
)

// ‚ùå NO OK (cross-module)
import "github.com/xKoRx/api-core/internal/service" // prohibido
```

## Observabilidad
- Un **span** por operaci√≥n cr√≠tica.
- M√©tricas de **latencia** y **volumen** por operaci√≥n.
- Logs JSON con atributos **comunes** desde contexto.

## Testing
- Table-driven. Mocks de adapters con `testify/mock`.
- Cobertura objetivo `core` ‚â•95%. Integraci√≥n en adapters y cmd seg√∫n riesgo.

## Checklist PR (bloqueante)
- [ ] Sin imports a otros m√≥dulos del monorepo.
- [ ] Config solo via `echo/sdk/etcd`, carga √∫nica.
- [ ] Spans + m√©tricas + logs con atributos en contexto.
- [ ] Tests y linters OK; `go vet` y `staticcheck` limpios.
